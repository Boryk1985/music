<script>
const player = document.getElementById("player");

const songs = [
  "Bassnectar - Butterfly (ft. Mimi Page) [OFFICIAL].mp3",
  "Enkidu - Falling.mp3",
  "MTNS - Fears.mp3",
  "Sea Oleena - Milk (Official Video).mp3",
  "The Glitch Mob - Becoming Harmonious.mp3"
];

function shuffle(arr) {
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
}

shuffle(songs);

let index = 0;
let started = false;

function playCurrent() {
  player.src = songs[index];
  player.play().catch(err => {
    console.log("Play blocked:", err);
  });
}

// ğŸ” LOOP PLAYLIST (THIS is what you were missing)
player.addEventListener("ended", () => {
  index++;

  if (index >= songs.length) {
    index = 0;
    shuffle(songs); // reshuffle each full cycle
  }

  playCurrent();
});

// Tumblr-required user gesture
document.addEventListener("click", () => {
  if (!started) {
    started = true;
    player.muted = false;
    playCurrent();
  }
});
</script>


